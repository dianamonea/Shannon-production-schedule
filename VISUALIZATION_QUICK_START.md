# 🤖 多智能体交互可视化系统

## 📋 快速导航

| 访问方式 | 入口 | 适用场景 |
|---------|------|--------|
| **网页版** | http://localhost:8888 | 快速查看、报告分享 |
| **桌面应用** | App → Agent Interaction | 集成监控、深度分析 |
| **实时演示** | `start-visualization.ps1` | 完整演示流程 |

---

## 🚀 一键启动

### 方式1：PowerShell（推荐 ⭐）

```powershell
.\start-visualization.ps1
```

选择菜单选项：
- **选项 1**：仅启动网页版
- **选项 2**：完整演示（演示 + 可视化）
- **选项 3**：仅启动可视化
- **选项 4**：仅运行演示

### 方式2：Batch Script

```cmd
start-visualization.bat
```

### 方式3：手动启动

```bash
# 网页版可视化
python visualization-server.py localhost 8888

# 在另一个终端运行演示
python production_scheduler_demo.py
```

---

## 📊 系统架构

```
┌─────────────────────────────────────────────────────────────┐
│                    Shannon 系统核心                          │
├─────────────────────────────────────────────────────────────┤
│                                                              │
│  ┌──────────────────────────────────────────────────────┐  │
│  │  生产调度演示 (production_scheduler_demo.py)         │  │
│  │  • 生成 6+ 生产扰动                                  │  │
│  │  • 三类智能体动态响应                                │  │
│  │  • 生成 JSON 结果文件                                │  │
│  └───────────────────┬──────────────────────────────────┘  │
│                      │                                       │
│                      ▼                                       │
│  ┌──────────────────────────────────────────────────────┐  │
│  │  调度结果 JSON (schedule_result_*.json)             │  │
│  │  • disturbances_detected: 扰动列表                  │  │
│  │  • disturbance_responses: 应对措施                  │  │
│  │  • coordination_timeline: 协同过程                  │  │
│  └───────────────────┬──────────────────────────────────┘  │
│                      │                                       │
│          ┌───────────┴───────────┐                          │
│          ▼                       ▼                           │
│  ┌──────────────────┐  ┌──────────────────┐               │
│  │  API 端点        │  │  Web 页面        │               │
│  │  /api/latest-    │  │  (HTML + JS)     │               │
│  │  schedule        │  │                  │               │
│  └────────┬─────────┘  │                  │               │
│           │            │                  │               │
│           └────┬───────┤                  │               │
│                ▼       ▼                  ▼               │
│         ┌─────────────────────────────────────┐          │
│         │  网页版可视化 (http://localhost:8888)│          │
│         │  • 实时显示扰动                     │          │
│         │  • 展示智能体交互                   │          │
│         │  • 统计数据仪表板                   │          │
│         └─────────────────────────────────────┘          │
│                      │                                      │
│                      ▼                                      │
│         ┌─────────────────────────────────────┐          │
│         │  桌面应用集成 (Desktop)               │          │
│         │  • Next.js 页面                     │          │
│         │  • 与会话联动                       │          │
│         │  • 主题适配                         │          │
│         └─────────────────────────────────────┘          │
│                                                            │
└─────────────────────────────────────────────────────────────┘
```

---

## 🎯 智能体交互流程示例

### 完整流程图

```
时间轴：14:27:43 ~ 14:27:44

┌─────────────────────────────────────────────────────┐
│ 1️⃣  扰动生成 (0ms)                                  │
│    - 6个随机扰动产生                                │
│    - 扰动类型：machine_failure, agv_breakdown ...  │
└────────────────┬────────────────────────────────────┘
                 │
                 ▼
┌─────────────────────────────────────────────────────┐
│ 2️⃣  机床智能体响应 (15ms)                            │
│    ⚠️  检测: urgent_order, quality_issue           │
│    ✅ 应对: 重新排序 + 预留返工时间                 │
│    📊 处理 4 个相关扰动                             │
└────────────────┬────────────────────────────────────┘
                 │
                 ▼
┌─────────────────────────────────────────────────────┐
│ 3️⃣  AGV智能体响应 (32ms)                            │
│    ⚠️  检测: agv_breakdown, material_delay         │
│    ✅ 应对: 启用备用车 + 优先配送                   │
│    📊 处理 3 个相关扰动                             │
└────────────────┬────────────────────────────────────┘
                 │
                 ▼
┌─────────────────────────────────────────────────────┐
│ 4️⃣  机器人智能体响应 (44ms)                          │
│    ⚠️  检测: operator_shortage                     │
│    ✅ 应对: 切换全自动模式                         │
│    📊 处理 3 个相关扰动                             │
└────────────────┬────────────────────────────────────┘
                 │
                 ▼
┌─────────────────────────────────────────────────────┐
│ 5️⃣  可视化展示 (完成)                               │
│    • 三类智能体状态卡                              │
│    • 扰动列表 (6个)                                │
│    • 交互时间线 (9个响应)                          │
│    • 统计数据仪表板                                │
└─────────────────────────────────────────────────────┘
```

---

## 📱 功能对比

| 功能 | 网页版 | 桌面应用 | 命令行 |
|-----|-------|---------|-------|
| 扰动显示 | ✅ | ✅ | ✅ |
| 交互流程 | ✅ | ✅ | ✅ |
| 实时更新 | ✅ | ✅ | - |
| 统计仪表板 | ✅ | ✅ | - |
| 深色主题 | ✅ | ✅ | - |
| 无需安装 | ✅ | - | ✅ |
| 集成会话 | - | ✅ | - |
| 响应式设计 | ✅ | ✅ | - |

---

## 📖 详细使用指南

### 1. 网页版使用

```bash
# 启动
python visualization-server.py localhost 8888

# 打开浏览器
http://localhost:8888
```

**功能**：
- 🔄 实时刷新数据
- 📊 三个智能体卡片
- ⚠️  扰动列表
- 🔗 交互时间线
- 📈 统计仪表板

### 2. 桌面应用使用

```
Shannon App → 左侧菜单 → "Agent Interaction"
```

**优势**：
- 与会话联动
- 深色/浅色主题
- 响应式布局
- 深度集成

### 3. 完整演示

```bash
# 运行启动脚本
.\start-visualization.ps1

# 选择选项 2 (完整演示)
# 自动执行：演示 + 可视化
```

---

## 🔍 关键数据展示

### 智能体状态卡

每个智能体显示：
```
┌──────────────────────────────┐
│ ⚙️  机床智能体                │
│ CNC-1/2/3                   │
├──────────────────────────────┤
│ 处理扰动: 4 个                │
│ 利用率:   95%                 │
│ 状态:    运行中 ✅            │
└──────────────────────────────┘
```

### 扰动卡片

```
🔴 [machine_failure] 高严重程度
  CNC-2 主轴轴承过热，需紧急维护
  📍 资源: cnc_2
  ⏱️ 影响: 120 分钟
```

### 交互项

```
⏰ 14:27:43 ⚙️ 机床智能体
   ⚠️  扰动: CNC-2 主轴轴承过热，需紧急维护
   ✅ 应对: 将 cnc_2 的任务转移到其他机床，预计延迟 120 分钟
```

---

## 📊 统计数据

实时显示：
- **机床处理**: 4 个扰动
- **AGV处理**: 3 个扰动  
- **机器人处理**: 3 个扰动
- **总计**: 6 个检测 + 9 个应对

---

## 🛠️ 技术栈

| 组件 | 技术 | 用途 |
|------|------|------|
| **后端** | Python 3.12 | 调度演示、API 服务 |
| **网页** | HTML5 + Tailwind CSS | 前端可视化 |
| **API** | Python HTTP Server | 数据接口 |
| **桌面** | Next.js + React | 应用集成 |
| **数据** | JSON | 格式化结果 |

---

## 🔗 文件映射

```
Shannon/
├── 📄 production_scheduler_demo.py
│   └─ 生产调度演示，生成 JSON 结果
│
├── 📄 visualization-server.py
│   └─ Web 服务器，提供 API + 页面
│
├── 🌐 agent-interaction-visualization.html
│   └─ 网页前端，使用 Tailwind CSS
│
├── ⚡ start-visualization.ps1
│   └─ PowerShell 启动脚本
│
├── 🖱️ start-visualization.bat
│   └─ Batch 启动脚本
│
└── 📚 AGENT_INTERACTION_VISUALIZATION.md
    └─ 详细文档

desktop/
├── app/(app)/agent-interaction/page.tsx
│   └─ 桌面应用可视化页面
│
└── app/api/latest-schedule/route.ts
    └─ 桌面应用 API 路由
```

---

## 🎓 学习资源

### 初级（开始使用）
1. 运行 `start-visualization.ps1` 选项 2
2. 查看网页版界面
3. 理解三类智能体的作用

### 中级（深入理解）
1. 修改 `production_scheduler_demo.py` 中的扰动参数
2. 观察智能体响应的变化
3. 分析应对措施的有效性

### 高级（扩展功能）
1. 修改 `agent-interaction-visualization.html` 样式
2. 添加自定义过滤器
3. 实现数据导出功能

---

## ❓ 常见问题

**Q: 网页无法加载数据？**
A: 确保已运行 `production_scheduler_demo.py` 生成 JSON 文件

**Q: 如何修改刷新频率？**
A: 编辑 `agent-interaction-visualization.html` 中的 `setInterval(2000, ...)` 参数

**Q: 能否在不同电脑上访问？**
A: 修改 `visualization-server.py` 中的 host 为 `0.0.0.0`

**Q: 桌面应用页面打不开？**
A: 检查 `desktop/app/api/latest-schedule/route.ts` 的文件路径

---

## 📞 支持和反馈

- 📧 Email: dev@shannon.ai
- 🐛 Bug Report: GitHub Issues
- 💬 Discussion: GitHub Discussions
- 📖 Documentation: 项目 Wiki

---

## 📄 许可证

MIT License - 详见 LICENSE 文件

---

**最后更新**: 2026-01-29  
**版本**: 1.0.0  
**维护者**: Shannon 多智能体系统团队

---

## 🎉 快速开始

```bash
# 1️⃣  进入项目目录
cd c:\Users\Administrator\Documents\GitHub\Shannon

# 2️⃣  运行启动脚本
.\start-visualization.ps1

# 3️⃣  选择选项 2 (完整演示)

# 4️⃣  打开浏览器访问
# http://localhost:8888

# 5️⃣  查看交互可视化 ✨
```

**就这样！🚀**
